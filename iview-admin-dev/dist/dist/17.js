webpackJsonp([17],{252:function(e,t,i){"use strict";function r(e){c||i(507)}Object.defineProperty(t,"__esModule",{value:!0});var o=i(436),l=i.n(o);for(var a in o)"default"!==a&&function(e){i.d(t,e,function(){return o[e]})}(a);var n=i(509),s=i.n(n),c=!1,p=i(4),u=r,h=p(l.a,s.a,!1,u,"data-v-12a6c4b2",null);h.options.__file="src\\views\\reptile-tool\\book.vue",t.default=h.exports},436:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(16),o=function(e){return e&&e.__esModule?e:{default:e}}(r);t.default={name:"book",components:{},data:function(){var e=this;return{indeterminate:!1,checkAll:!0,bookName:"",loading:!1,columns:[{title:"标题",key:"title",width:400,render:function(e,t){return e("div",[e("span",t.row.title),e("span",{attrs:{style:"color:red"}},"("+t.row.status+")")])}},{title:"作者",key:"author"},{title:"来源",key:"reptileType",render:function(t,i){return t("span",{attrs:{}},e.remarkList[i.row.reptileType])}},{title:"爬取地址",key:"url",render:function(e,t){return e("a",{attrs:{href:t.row.url,target:"_blank"}},t.row.url)}},{title:"爬取",key:"",render:function(t,i){return t("a",{attrs:{href:"javascript:void(0);",id:i.row.title+"_"+i.row.author},on:{click:function(){e.onClickReptileTool(i)}}},i.row.reptile)}}],list:[],reptileType:[],reptileList:[],remarkList:{},isProxy:!0}},computed:{},methods:{handleCheckAll:function(e){var t=this;if(e)return void(this.reptileType.length==this.reptileList.length?(this.indeterminate=!1,this.checkAll=!0):this.reptileType.length>0?(this.indeterminate=!0,this.checkAll=!1):(this.indeterminate=!1,this.checkAll=!1));this.indeterminate?this.checkAll=!1:this.checkAll=!this.checkAll,this.checkAll?(this.reptileType=[],this.reptileList.forEach(function(e,i){t.reptileType.push(e.reptileTypeId)})):this.reptileType=[]},checkAllGroupChange:function(e){e.length===this.reptileList.length?(this.indeterminate=!1,this.checkAll=!0):e.length>0?(this.indeterminate=!0,this.checkAll=!1):(this.indeterminate=!1,this.checkAll=!1)},onClickSearch:function(){var e=this;if(this.bookName&&this.bookName.trim()&&!this.loading){localStorage.bookName=this.bookName;var t=this.reptileType.join(",");localStorage.reptileType=t,localStorage.isProxy=this.isProxy,this.$router.replace("/reptile-tool/book?bookName="+this.bookName+"&reptileType="+t+"&isProxy="+this.isProxy);var i={params:{bookName:this.bookName,reptileType:t,isProxy:this.isProxy}};this.loading=!0,o.default.post.reptile.getUrl(i,{timeout:1e4}).then(function(t){e.list=t.urlList,t.errorArr.forEach(function(t,i){e.$Message.error(t)}),e.loading=!1}).catch(function(t){e.loading=!1})}},onClickReptileTool:function(e){var t=document.getElementById(e.row.title+"_"+e.row.author).innerHTML;if("已获取"!=t&&"正在获取中"!=t){document.getElementById(e.row.title+"_"+e.row.author).innerHTML="正在获取中";var i={params:{bookName:e.row.title,bookUrl:e.row.url,author:e.row.author,reptileType:e.row.reptileType}};o.default.post.reptile.getBookJson(i).then(function(t){document.getElementById(e.row.title+"_"+e.row.author).innerHTML="已获取"}).catch(function(t){document.getElementById(e.row.title+"_"+e.row.author).innerHTML="获取失败"})}},getReptileList:function(){var e=this,t={params:{}},i=[];o.default.post.reptile.list(t).then(function(t){t.reptileList.forEach(function(t,r){1==t.isSearch?(t.reptileTypeId=t.reptileTypeId+"",e.remarkList[t.reptileTypeId]=t.name,i.push(t)):t=null}),e.reptileList=e.reptileList.concat(i),e.reptileType=e.$route.query.reptileType&&e.$route.query.reptileType.split(",")||localStorage.reptileType&&localStorage.reptileType.split(",")||[]}).catch(function(e){})},activatedStart:function(){this.handleCheckAll(!0);var e="";this.$route.query.bookName?e=this.$route.query.bookName:localStorage.bookName&&(e=localStorage.bookName);var t=this.reptileType.join(",");this.$route.query.reptileType?t=this.$route.query.reptileType:localStorage.reptileType&&(t=localStorage.reptileType);var i=this.isProxy;this.$route.query.isProxy?i="true"==this.$route.query.isProxy:localStorage.isProxy&&(i="true"==localStorage.isProxy),this.bookName==e&&this.reptileType==t&&this.isProxy==i||(this.reptileType=t.split(","),this.bookName=e,this.isProxy=i,this.onClickSearch())},start:function(){var e=this;if(this.reptileList.length>0)this.activatedStart();else var t=setTimeout(function(){e.start(),clearTimeout(t),t=null},300)}},created:function(){this.getReptileList()},mounted:function(){},activated:function(){this.start()},deactivated:function(){}}},507:function(e,t,i){var r=i(508);"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);i(19)("1ae6f499",r,!1,{})},508:function(e,t,i){t=e.exports=i(18)(!1),t.push([e.i,"\n.span-title[data-v-12a6c4b2] {\n  vertical-align: middle;\n}\n",""])},509:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("Layout",[i("Card",{attrs:{shadow:""}},[i("Row",[i("Col",{attrs:{span:"20"}},[i("span",{staticClass:"span-title"},[e._v("搜索配置：")]),e._v(" "),i("Checkbox",{attrs:{indeterminate:e.indeterminate,value:e.checkAll},nativeOn:{click:function(t){t.preventDefault(),e.handleCheckAll()}}},[e._v("全选")]),e._v(" "),i("CheckboxGroup",{staticStyle:{display:"inline-block"},on:{"on-change":e.checkAllGroupChange},model:{value:e.reptileType,callback:function(t){e.reptileType=t},expression:"reptileType"}},e._l(e.reptileList,function(t){return i("Checkbox",{key:t.reptileTypeId,attrs:{label:t.reptileTypeId}},[e._v(e._s(t.name))])}))],1)],1)],1),e._v(" "),i("Card",[i("Row",[i("Col",{attrs:{span:"18"}},[i("span",{staticClass:"span-title"},[e._v("搜索小说名或作者名：")]),e._v(" "),i("Input",{staticClass:"w300",attrs:{placeholder:"请输入您想爬取的小说名或者作者名",clearable:""},nativeOn:{keyup:function(t){return"button"in t||13===t.keyCode?e.onClickSearch(t):null}},model:{value:e.bookName,callback:function(t){e.bookName=t},expression:"bookName"}})],1),e._v(" "),i("Col",{staticClass:"tr",attrs:{span:"6"}},[i("span",[e._v("启用代理搜索：")]),e._v(" "),i("i-switch",{staticClass:"mr20",attrs:{disabled:e.loading},model:{value:e.isProxy,callback:function(t){e.isProxy=t},expression:"isProxy"}}),e._v(" "),i("Button",{attrs:{type:"primary"},on:{click:e.onClickSearch}},[e._v("搜索")])],1)],1)],1),e._v(" "),i("Card",{attrs:{shadow:""}},[i("Table",{ref:"table",attrs:{border:"","highlight-row":"",loading:e.loading,columns:e.columns,data:e.list}})],1)],1)},o=[];r._withStripped=!0;var l={render:r,staticRenderFns:o};t.default=l}});