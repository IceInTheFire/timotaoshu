webpackJsonp([15],{250:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=o(433),a=o.n(i);for(var n in i)"default"!==n&&function(t){o.d(e,t,function(){return i[t]})}(n);var r=o(498),l=o.n(r),s=o(4),c=s(a.a,l.a,!1,null,null,null);c.options.__file="src\\views\\reptile-tool\\progress-error.vue",e.default=c.exports},278:function(t,e,o){t.exports={default:o(279),__esModule:!0}},279:function(t,e,o){o(280),t.exports=o(0).Object.assign},280:function(t,e,o){var i=o(8);i(i.S+i.F,"Object",{assign:o(281)})},281:function(t,e,o){"use strict";var i=o(26),a=o(54),n=o(34),r=o(33),l=o(94),s=Object.assign;t.exports=!s||o(20)(function(){var t={},e={},o=Symbol(),i="abcdefghijklmnopqrst";return t[o]=7,i.split("").forEach(function(t){e[t]=t}),7!=s({},t)[o]||Object.keys(s({},e)).join("")!=i})?function(t,e){for(var o=r(t),s=arguments.length,c=1,u=a.f,d=n.f;s>c;)for(var p,f=l(arguments[c++]),h=u?i(f).concat(u(f)):i(f),m=h.length,g=0;m>g;)d.call(f,p=h[g++])&&(o[p]=f[p]);return o}:s},433:function(t,e,o){"use strict";function i(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var a=o(278),n=i(a),r=o(16),l=i(r);e.default={name:"progress-error",data:function(){var t=this;return{loading:!1,reptileList:{length:0},columns:[{title:"id",key:"id"},{title:"备注",key:"reptileType",render:function(e,o){return e("span",{},""+t.reptileList[o.row.reptileType].name)}},{title:"书名",key:"bookName"},{title:"章节名",key:"catalogName",render:function(e,o){return e("a",{attrs:{href:"javascript:void(0)",target:"_blank"},on:{click:function(){t.onJumpToCatalogInfo(o.row.bookName,o.row.catalogName)}}},o.row.catalogName)}},{title:"来源地址",key:"originUrl",render:function(t,e){var o="";return o=0===e.row.reptileAddress.indexOf("http")?e.row.reptileAddress:e.row.originUrl+e.row.reptileAddress,t("a",{attrs:{href:o,target:"_blank"}},o)}},{title:"操作",key:"handle",render:function(e,o){return e("div",[e("a",{attrs:{href:"javascript:void(0);",style:"margin-left:10px;"},on:{click:function(){t.onClickDel(o.row.id)}}},"删除"),e("a",{attrs:{href:"javascript:void(0);",style:"margin-left:10px;",id:o.row.title+"_"+o.row.id},on:{click:function(){t.onClickUpdate(o)}}},"爬取"),e("a",{attrs:{href:"https://www.baidu.com/s?wd="+o.row.bookName,style:"margin-left:10px;",target:"_blank"}},"其他来源")])}}],list:[],params:{page:1,limit:10},total:0,bookName:"",showSimpleReptile:"",first:!0}},computed:{},methods:{onClickSearch:function(t){var e=this;if(!this.loading){t&&(this.params.page=t),this.bookName?this.showSimpleReptile=this.bookName:this.showSimpleReptile="";var o={params:{page:this.params.page,limit:this.params.limit}};this.bookName&&(o.params.bookName=this.bookName),this.$router.replace({path:"/reptile-tool/progress-error",query:(0,n.default)({},o.params)}),this.loading=!0,l.default.post.reptile.getProgressList(o).then(function(t){e.list=t.data,e.total=t.count,e.loading=!1}).catch(function(t){e.loading=!1})}},onClickDel:function(t){var e=this,o={params:{errorId:t}};this.loading=!0,l.default.post.reptile.deleteError(o).then(function(t){e.$Message.success(t),e.loading=!1,e.onClickSearch()}).catch(function(t){e.loading=!1})},onClickUpdate:function(t){var e=this,o=document.getElementById(t.row.title+"_"+t.row.id).innerHTML;if("已获取"!=o&&"正在获取中"!=o){document.getElementById(t.row.title+"_"+t.row.id).innerHTML="正在获取中";var i={params:{errorId:t.row.id}};l.default.post.reptile.restartCatalog(i).then(function(t){e.$Message.success(t),e.onClickSearch()}).catch(function(e){document.getElementById(t.row.title+"_"+t.row.id).innerHTML="获取失败"})}},onClickOneKey:function(t){var e=this,o={params:{}};"all"==t||(o.params.bookName=this.showSimpleReptile),this.loading=!0,l.default.post.reptile.oneKeyRestartCatalog(o).then(function(t){e.$Message.success(t),e.onClickSearch(),e.loading=!1}).catch(function(t){e.loading=!1})},onJumpToCatalogInfo:function(t,e){var o=this,i={params:{bookName:t,catalogName:e}};this.loading=!0,l.default.post.common.getCatalogFromInfo(i).then(function(t){if(o.loading=!1,t.count>0){var e=t.data[0],i=document.createElement("a");return i.href="/#/bookContainer?bookId="+e.bookId+"&catalogId="+e.id+"&num="+e.num,i.style.display="none",i.setAttribute("target","_blank"),i.click(),void i.remove()}o.$message.error("未知错误")}).catch(function(t){console.error(t),o.loading=!1})},getReptileList:function(){var t=this,e={params:{}};l.default.post.reptile.list(e).then(function(e){t.reptileList={},e.reptileList.forEach(function(e,o){t.reptileList[e.reptileTypeId]=e}),t.reptileList.length=e.reptileList.length}).catch(function(t){})},activatedStart:function(){var t=this.$route.query.bookName||"";(t!=this.bookName||this.first)&&(this.bookName=t,this.onClickSearch(),this.first=!1)},start:function(){var t=this;if(this.reptileList.length>0)this.activatedStart();else var e=setTimeout(function(){t.start(),clearTimeout(e),e=null},300)}},components:{},created:function(){this.getReptileList()},mounted:function(){},beforeDestroy:function(){},destroyed:function(){},activated:function(){this.start()},deactivated:function(){}}},498:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("Layout",[o("Card",[o("Row",[o("Col",{attrs:{span:"24"}},[o("Input",{staticClass:"w200",attrs:{placeholder:"输入书名",clearable:""},nativeOn:{keyup:function(e){if(!("button"in e)&&13!==e.keyCode)return null;t.onClickSearch(1)}},model:{value:t.bookName,callback:function(e){t.bookName=e},expression:"bookName"}}),t._v(" "),o("Button",{attrs:{type:"primary"},on:{click:function(e){t.onClickSearch(1)}}},[t._v("搜索")]),t._v(" "),t.showSimpleReptile?o("Button",{attrs:{type:"primary"},on:{click:function(e){t.onClickOneKey()}}},[t._v(t._s(t.showSimpleReptile)+"一键爬取")]):t._e(),t._v(" "),o("Button",{staticClass:"fr",attrs:{type:"primary"},on:{click:function(e){t.onClickOneKey("all")}}},[t._v("全部一键爬取")])],1)],1)],1),t._v(" "),o("Card",{attrs:{shadow:""}},[o("Table",{ref:"table",attrs:{border:"","highlight-row":"",loading:t.loading,columns:t.columns,data:t.list}})],1),t._v(" "),o("Card",{attrs:{shadow:""}},[o("Page",{attrs:{current:t.params.page,"page-size":t.params.limit,total:t.total,"show-total":""},on:{"on-change":t.onClickSearch}})],1)],1)},a=[];i._withStripped=!0;var n={render:i,staticRenderFns:a};e.default=n}});